<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Floorball Team Picker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- mobile scaling -->
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      padding: 12px;
      background: #3a52a3;
      text-align: center;
      border-radius: 8px;
      color: #fff;
      font-size: clamp(1.5rem, 5vw, 2rem);
    }
    textarea, input {
      width: 100%;
      display: block;
      margin: 6px auto 12px auto;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    textarea {
      resize: none;
      min-height: 100px;
    }
    .button-wrapper {
      display: flex;
      justify-content: center;
    }
    .image-button {
      display: block;
      margin: 0 auto;
      width: 85px;
      height: auto;
      cursor: pointer;
      filter: invert(29%) sepia(74%) saturate(488%) hue-rotate(189deg) brightness(100%) contrast(103%);
      transition: transform 0.15s ease;
    }
    .image-button:hover {
      transform: scale(1.1);
    }
    .image-button:active {
      transform: scale(0.95);
    }
    #buttonText {
      text-align: center;
      font-size: 0.95rem;
      color: #555;
      margin-top: 10px;
    }
    .team {
      background: #fff;
      padding: 12px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    #title-container {
      text-align: center;
    }
    #title-container img {
      width: 60px;
      height: 60px;
      margin-bottom: 10px;
    }

    /* --- Added chip selector styling --- */
    .chips-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    #clearChipsBtn {
      background: #ba006f;
      color: white;
      border: none;
      border-radius: 16px;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.2s ease, transform 0.1s ease, opacity 0.3s ease;
      opacity: 0;
      pointer-events: none;
    }

    #clearChipsBtn.visible {
      opacity: 1;
      pointer-events: auto;
    }

    #clearChipsBtn:hover {
      background: #ea189f;
    }

    #clearChipsBtn:active {
      transform: scale(0.95);
    }

    .chips-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 8px 0 12px 0;
    }

    .chip {
      padding: 8px 14px;
      background: #e0e0e0;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: all 0.2s ease;
      user-select: none;
    }

    .chip:hover {
      background: #d0d0d0;
    }

    .chip.selected {
      background: #3a52a3;
      color: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }
  </style>
</head>
<body>
  <h1>Floorball Team Picker</h1>

  <!-- ✅ Added chips above textarea -->
  <div class="chips-header">
    <label>Select common players:</label>
    <button id="clearChipsBtn" type="button" onclick="clearAllPlayers()">Clear All</button>
  </div>
  <div id="playerChips" class="chips-container"></div>

  <label for="names">Enter player names (comma separated):</label>
  <textarea id="names" rows="5" placeholder="Brunchie, Eugene, ..."></textarea>

  <label for="teamSize">Team size:</label>
  <input type="number" id="teamSize" min="1" placeholder="e.g. 3">

  <div class="button-wrapper">
    <img src="Floorball_Blk@2x.png" alt="Generate Teams" class="image-button" onclick="generateTeams()">
  </div>
  <p id="buttonText">Click the floorball to generate teams</p>

  <h2>Teams:</h2>
  <div id="output"></div>

  <script>
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function generateTeams() {
      let names = document.getElementById("names").value.split(",");
      names = names.map(n => n.trim()).filter(n => n);
      let teamSize = parseInt(document.getElementById("teamSize").value);

      if (!teamSize || teamSize < 1) {
        alert("Please enter a valid team size.");
        return;
      }

      shuffle(names);

      const teamNames = [
        "Slapshot Tarts", "The Five-Hole Fiddlers", "The Floorgasms", "The Ball Busters", "Goal Diggers",
        "Rink Runners", "The Cuck Bunnies", "The Sweepers", "Ball Blazers",
        "Stick Flickers", "The Mighty Dangles", "Deez Sticks", "The Faceoff Crew",
        "Floor Fury", "Stick Storm", "The Dirty Dekes",
        "Stickflix and Chill", "The Deflectors", "Balls to the Floor", "Ballz Deep", "Just the Tip-Ins", "Balls of Fury", "The Slap and Tickles",
      ];

      shuffle(teamNames); // randomize team names too

      let output = "";
      let numTeams = Math.floor(names.length / teamSize);

      if (numTeams === 0) {
        output = "<p>Not enough players for the chosen team size.</p>";
      } else {
        for (let i = 0; i < numTeams; i++) {
          let team = names.slice(i * teamSize, (i + 1) * teamSize);
          let teamName = teamNames[i % teamNames.length];
          output += `<div class="team"><strong>${teamName}:</strong> ${team.join(", ")}</div>`;
        }

        let leftovers = names.slice(numTeams * teamSize);
        if (leftovers.length) {
          output += `<div class="team"><strong>Leftover players:</strong> ${leftovers.join(", ")}</div>`;
        }
      }

      document.getElementById("output").innerHTML = output;
    }

    /* ✅ Added chip logic below */
    const commonPlayers = [
      "Brunchie", "Eugene", "Tanya", "Kev", "Rex", "Mitch",
      "Yasmin", "Connor", "Lauren", "Perry"
    ];

    function createPlayerChips() {
      const container = document.getElementById("playerChips");
      container.innerHTML = "";
      commonPlayers.forEach(name => {
        const chip = document.createElement("div");
        chip.className = "chip";
        chip.textContent = name;
        chip.onclick = () => togglePlayer(name, chip);
        container.appendChild(chip);
      });
    }

    function togglePlayer(name, chip) {
      const textarea = document.getElementById("names");
      let names = textarea.value.split(",").map(n => n.trim()).filter(n => n);

      if (names.includes(name)) {
        names = names.filter(n => n !== name);
        chip.classList.remove("selected");
      } else {
        names.push(name);
        chip.classList.add("selected");
      }

      textarea.value = names.join(", ");
      updateClearButtonVisibility();
    }

    function syncChipsWithTextarea() {
      const textarea = document.getElementById("names");
      const names = textarea.value.split(",").map(n => n.trim()).filter(n => n);
      document.querySelectorAll(".chip").forEach(chip => {
        if (names.includes(chip.textContent)) {
          chip.classList.add("selected");
        } else {
          chip.classList.remove("selected");
        }
      });
      updateClearButtonVisibility();
    }

    function clearAllPlayers() {
      document.getElementById("names").value = "";
      document.querySelectorAll(".chip").forEach(chip => chip.classList.remove("selected"));
      updateClearButtonVisibility();
    }

    function updateClearButtonVisibility() {
      const textarea = document.getElementById("names");
      const btn = document.getElementById("clearChipsBtn");
      const hasPlayers = textarea.value.trim().length > 0;
      btn.classList.toggle("visible", hasPlayers);
    }

    const originalGenerateTeams = generateTeams;
    generateTeams = function() {
      originalGenerateTeams();
      syncChipsWithTextarea();
    };

    window.addEventListener("DOMContentLoaded", () => {
      createPlayerChips();
      document.getElementById("names").addEventListener("input", syncChipsWithTextarea);
      updateClearButtonVisibility();
    });
  </script>
</body>
</html>
